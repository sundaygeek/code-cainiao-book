# vers. 1.1 # 2016 09 23### ----- 第1章 ----- #### Code01-01（P.25 01-06）# ======================# R语言会忽略井号（#）右侧的命令。我们可以利用这一性质，将笔记或注释写在#右侧choujiang <- c("未中奖","一等奖")# 现在是要每天抽100次奖，重复7天，然后统计一等奖出现的次数# 我们写一条命令让上述过程重复执行1000次，并将结果以res为名称保存# 格式：replicate(1000, sum(replicate(7, 抽100次奖时出现一等奖的次数)))res <- replicate(1000, sum(replicate (7, sample (choujiang, 100, prob = c(99,1), replace = TRUE) ) == "一等奖"))# 简单的直方图hist(res, breaks = 0:18)# 如果想生成更精致的图，需要安装制图软件包ggplot2（需要网络）install.packages("ggplot2")library(ggplot2) # 使用前需要先加载# 对抽奖数据稍作加工，以便用ggplot2程序包绘图resD <- as.data.frame(table(res))# 只显示头10行数据head(resD, n = 10)# 实际绘图ggplot(resD, aes(y = Freq, x = res)) +  geom_histogram(binwidth = 1, stat="identity", fill = "steelblue") + xlab("该周大奖出现次数") + ylab ("周数") + ggtitle("直方图") + theme(text = element_text(family = "Heiti SC Light"))# 若图中的汉字无法正常显示，可通过“ + theme(text = element_text(family = "Heiti SC Light"))”指定汉字的字体# 在最新版本的ggplot2程序包中，由于geom_histogram函数的格式发生了变化，# 所以若上面的最后1行代码执行后报错（Error: Unknown parameters: binwidth, bins, pad），请改用下面这2行代码生成直方图resD <- as.data.frame(res)ggplot(resD, aes(x = res)) + geom_histogram(binwidth = 1, color = "white", fill = "steelblue") + xlab("该周大奖出现次数") + ylab ("周数") + ggtitle("直方图") + theme(text = element_text(family = "Heiti SC Light"))# Code01-02（P.47 01-12）# ======================# 骰子的平均值和期望值# 这里也要用到循环执行命令的replicate函数res <- replicate(100000,  mean (sample(1:6, 100,replace = TRUE)))# 简单的直方图hist(res)# 生成更精致的图library(ggplot2)# 略微修改掷骰子的结果数据，便于绘图dice <- data.frame(骰子 = res)# 实际绘图ggplot(dice, aes (x = 骰子)) + geom_histogram(binwidth = .1, fill = "steelblue", colour = "black", alpha = 0.5) + xlab("期望值") + ylab ("次数") + ggtitle("掷100次骰子后的期望值") + theme(text = element_text(family = "Heiti SC Light"))# 01-06（P.23）# ============# 用R语言模拟抽奖# 将“抽奖箱”（数据）命名为choujiang，里面装入“未中奖”和“一等奖”choujiang <- c("未中奖","一等奖")# 查看choujiang的内容choujiang# 虽然“抽奖箱”choujiang中只有2个元素，但在R语言中通过sample函数，即可使“未中奖”和“一等奖”以99比1的比例出现# 该函数会随机取出数据，所以每次执行结果都不一定相同# 下面的写法表示只抽1次奖sample(choujiang, 1, prob = c(99, 1))# 在模拟抽100次奖的命令中，通过添加replace = TRUE，即可使每次抽奖时“未中奖”和“一等奖”的比例都是99比1sample(choujiang, 100, prob = c(99, 1), replace = TRUE)# 模拟每天抽100次奖，连续抽1周# 输出的是一个100行7列的数据# replicate函数的作用是将命令执行指定次数# 格式：replicate(次数, 命令)replicate(7, sample(choujiang, 100, prob = c(99, 1), replace = TRUE))# 统计出“一等奖”出现的次数# 通过“sum(A == "一等奖")”，即可统计出A里面出现了多少次“一等奖”sum(replicate(7, sample(choujiang, 100, prob = c(99, 1), replace = TRUE) ) == "一等奖")# 01-08（P.35）# ============# 用RStudio进行加法运算1 + 2 + 3 + 4 + 5# 01-09（P.36）# ============# 用RStudio计算1～1000的整数之和sum(1:1000)# 01-10（P.39）# ============# 1～6的整数1:6# 用sample函数实现从1到6的整数中随机取出1个sample(1:6, 1)sample(1:6, 1)# 掷100次骰子，或者可以看作同时掷出100个骰子sample(1:6, 100, replace = TRUE)# 再次回到模拟抽奖的例子choujiang <- c("未中奖","一等奖")# 模拟100次“未中奖”和“一等奖”的放回抽样sample(choujiang, 100, prob = c(99, 1), replace = TRUE)# 01-11（P.43）# ============# 生成频率分布表table(sample(1:6, 100, replace = TRUE))# 生成直方图hist(sample (1:6, 10000, replace = TRUE), breaks = 0:6)# 01-12（P.46）# ============# 掷100次骰子时出现的点数的平均值# 由于掷出的点数是随机的，所以每次执行结果会稍有不同mean(sample (1:6, 100, replace = TRUE))# hist和geom_histogram函数（P.53）# ===============================# 模拟掷10000次骰子，绘制出直方图res <- sample(1:6, 10000, replace = TRUE)# 简单的直方图# breaks=0:6用于设置横轴跨度hist(res, breaks = 0:6)# 对数据稍作加工，以便生成更精致的图dice <- data.frame(骰子 = res)# 查看开头部分head(dice)# 生成更精致的直方图ggplot(dice, aes (x = 骰子)) + geom_histogram(binwidth = 1, fill = "steelblue", colour = "black", alpha = 0.5) + xlab("掷出的点数") + ylab ("次数") + ggtitle("掷10000次骰子的结果") + theme(text = element_text(family = "Heiti SC Light"))